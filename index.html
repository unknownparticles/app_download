<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>è‡ªå¾‹æ˜Ÿçƒ Â· Android å®‰è£…åŒ…ä¸‹è½½</title>
  <meta name="description" content="è‡ªå¾‹æ˜Ÿçƒï¼ˆFitness Tracker Appï¼‰â€” åŸºäº AI çš„å¥èº«è®¡åˆ’ä¸æ‰“å¡åŠ©æ‰‹ã€‚ä¸‹è½½ Android APK å®‰è£…åŒ…ã€‚" />
  <style>
    :root {
      --bg: #0b1020;
      --card: #101729;
      --text: #e7ecf5;
      --muted: #9fb0c6;
      --primary: #31c48d;
      --primary-press: #22a06f;
      --border: #1e2a44;
    }
    * { box-sizing: border-box; }
    html, body { margin:0; padding:0; background: linear-gradient(160deg, #0b1020 0%, #0f1b34 100%); color: var(--text); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", "PingFang SC", "Noto Sans SC", "Microsoft YaHei", Arial, sans-serif; }
    a { color: inherit; text-decoration: none; }
    .wrap { max-width: 880px; margin: 0 auto; padding: 24px; }
    .card {
      background: radial-gradient(1200px 600px at 90% -10%, rgba(49,196,141,.08), transparent 60%),
                  radial-gradient(800px 400px at -10% 20%, rgba(79,70,229,.08), transparent 60%),
                  var(--card);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 28px;
      box-shadow: 0 20px 50px rgba(0,0,0,.35);
    }
    header { display:flex; align-items:center; gap:14px; margin-bottom: 14px; }
    .logo {
      width:40px;height:40px;border-radius:12px;
      background: linear-gradient(135deg, #34d399, #22d3ee);
      box-shadow: inset 0 0 16px rgba(255,255,255,.25);
    }
    h1 { font-size: 22px; margin:0; letter-spacing: .5px; }
    .sub { color: var(--muted); font-size: 14px; margin-top: 2px; }
    .hero {
      display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:16px; margin: 18px 0 8px;
    }
    .btn {
      display:inline-flex; align-items:center; justify-content:center; gap:10px;
      padding: 14px 18px; border-radius: 14px; font-weight: 600; letter-spacing:.2px;
      background: var(--primary); color:#062416; border: 1px solid rgba(255,255,255,.06);
      transition: transform .06s ease, background .12s ease;
    }
    .btn:active { transform: translateY(1px); background: var(--primary-press); }
    .ghost {
      background: transparent; color: var(--text); border:1px dashed var(--border);
    }
    .meta {
      display:flex; flex-wrap:wrap; gap:10px; align-items:center; color: var(--muted); font-size: 13px;
    }
    .pill {
      border:1px solid var(--border); border-radius:999px; padding:4px 10px; background: rgba(255,255,255,.03);
    }
    .warn {
      margin-top: 10px; font-size: 13px; color: #ffd7a6;
    }
    .section { margin-top: 22px; }
    h2 { font-size: 16px; margin: 0 0 10px; color:#dbe7ff; }
    .code {
      background: #0a1326; border:1px solid var(--border); border-radius: 12px; padding: 12px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size: 12px; color:#eaf2ff;
      display:flex; justify-content:space-between; align-items:center; gap:12px; overflow:auto;
    }
    .copy { cursor:pointer; user-select:none; font-size: 12px; color:#9fd6ff; padding:6px 10px; border:1px solid var(--border); border-radius:8px; }
    .changelog { border:1px solid var(--border); border-radius: 16px; padding: 14px; background: rgba(255,255,255,.02); }
    .changelog .item { border-top:1px dashed var(--border); padding-top:10px; margin-top:10px; }
    .changelog .item:first-child { border-top:0; padding-top:0; margin-top:0; }
    footer { margin: 24px 0 8px; text-align:center; color: var(--muted); font-size: 12px;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>è‡ªå¾‹æ˜Ÿçƒï¼ˆFitness Tracker Appï¼‰</h1>
          <div class="sub">åŸºäº AI çš„å¥èº«è®¡åˆ’ä¸æ‰“å¡åŠ©æ‰‹ Â· Android APK ä¸‹è½½</div>
        </div>
      </header>

      <div class="hero">
        <div class="meta">
          <span class="pill">ç‰ˆæœ¬ï¼š<b id="ver">åŠ è½½ä¸­â€¦</b></span>
          <span class="pill">å‘å¸ƒæ—¥æœŸï¼š<b id="pub">â€”</b></span>
          <span class="pill">æ–‡ä»¶ï¼š<b id="fname">app-release.apk</b></span>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <a id="dl" class="btn" href="#" rel="noopener" download>
            ğŸ“¥ ç«‹å³ä¸‹è½½ APK
          </a>
          <a id="rel" class="btn ghost" href="#" target="_blank" rel="noopener">
            ğŸ§¾ æŸ¥çœ‹ Release
          </a>
        </div>
      </div>

      <div id="iosWarn" class="warn" style="display:none;">æ£€æµ‹åˆ° iOS è®¾å¤‡ï¼šæœ¬åº”ç”¨ä¸º Android APKï¼Œæ— æ³•ç›´æ¥å®‰è£…ã€‚</div>

      <div class="section">
        <h2>ğŸ” æ ¡éªŒå€¼ï¼ˆSHA-256ï¼‰</h2>
        <div class="code">
          <span id="sha">å°šæœªæä¾›</span>
          <button class="copy" id="copyBtn" aria-label="å¤åˆ¶ SHA256">å¤åˆ¶</button>
        </div>
        <div class="sub" style="margin-top:8px;">å¦‚ä¸‹è½½åå®‰è£…å¤±è´¥æˆ–è¢«æ‹¦æˆªï¼Œè¯·æ¯”å¯¹æ ¡éªŒå€¼æ˜¯å¦ä¸€è‡´ã€‚</div>
      </div>

      <div class="section">
        <h2>ğŸ“ ç‰ˆæœ¬è¯´æ˜</h2>
        <div id="notes" class="changelog">
          <div class="item">æ­£åœ¨è¯»å– GitHub Release ä¿¡æ¯â€¦</div>
        </div>
      </div>
    </div>

    <footer>
      Â© <span id="y"></span> è‡ªå¾‹æ˜Ÿçƒ Â· ä»…ä¾›å­¦ä¹ ä½“éªŒä½¿ç”¨
    </footer>
  </div>

  <script>
    // ========= åŸºæœ¬é…ç½® =========
    const OWNER = "unknownparticles";
    const REPO = "fitness_tracker_app";

    // æ”¯æŒé€šè¿‡ URL å¼ºåˆ¶æŒ‡å®š tagï¼Œå¦‚ï¼š?tag=v1.0.1
    const params = new URLSearchParams(location.search);
    const FORCE_TAG = params.get("tag");

    // iOS æç¤º
    (function(){
      const ua = navigator.userAgent || "";
      const isIOS = /iPhone|iPad|iPod/i.test(ua);
      if (isIOS) document.getElementById("iosWarn").style.display = "block";
    })();

    // å¹´ä»½
    document.getElementById("y").textContent = new Date().getFullYear();

    // å¤åˆ¶ SHA256
    document.getElementById("copyBtn").addEventListener("click", async () => {
      const shaText = document.getElementById("sha").textContent.trim();
      if (!shaText || shaText === "å°šæœªæä¾›") return;
      try {
        await navigator.clipboard.writeText(shaText);
        const btn = document.getElementById("copyBtn");
        btn.textContent = "å·²å¤åˆ¶ âœ“";
        setTimeout(() => (btn.textContent = "å¤åˆ¶"), 1600);
      } catch (_) {}
    });

    // è§£æ Release body ä¸­çš„ sha256: xxxxx
    function extractSHA(body) {
      if (!body) return null;
      const m = body.match(/sha256\s*:\s*([a-f0-9]{64})/i);
      return m ? m[1] : null;
    }

    // ä¼˜å…ˆé€‰æ‹© app-release.apkï¼›å¦åˆ™é€‰æ‹©ç¬¬ä¸€ä¸ª .apk
    function pickApk(assets) {
      if (!Array.isArray(assets)) return null;
      const exact = assets.find(a => a && a.name && a.name.toLowerCase() === "app-release.apk" && /\.apk$/i.test(a.name));
      if (exact) return exact;
      return assets.find(a => a && a.name && /\.apk$/i.test(a.name)) || null;
    }

    async function fetchJson(url) {
      const res = await fetch(url + (url.includes("?") ? "&" : "?") + "t=" + Date.now(), { cache: "no-store" });
      if (!res.ok) throw new Error("HTTP " + res.status);
      return res.json();
    }

    async function loadRelease() {
      const verEl = document.getElementById("ver");
      const pubEl = document.getElementById("pub");
      const dlBtn = document.getElementById("dl");
      const relBtn = document.getElementById("rel");
      const notes = document.getElementById("notes");
      const shaEl = document.getElementById("sha");
      const fnameEl = document.getElementById("fname");

      try {
        let data;
        if (FORCE_TAG) {
          // æŒ‡å®š tag
          data = await fetchJson(`https://api.github.com/repos/${OWNER}/${REPO}/releases/tags/${encodeURIComponent(FORCE_TAG)}`);
        } else {
          // æœ€æ–°ç¨³å®šç‰ˆï¼ˆé draft/prereleaseï¼‰
          data = await fetchJson(`https://api.github.com/repos/${OWNER}/${REPO}/releases/latest`);
        }

        // ç‰ˆæœ¬å·
        verEl.textContent = data.tag_name || "â€”";

        // å‘å¸ƒæ—¥æœŸ
        if (data.published_at) {
          const d = new Date(data.published_at);
          pubEl.textContent = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;
        } else {
          pubEl.textContent = "â€”";
        }

        // èµ„äº§é€‰æ‹©
        const apk = pickApk(data.assets || []);
        if (apk && apk.browser_download_url) {
          dlBtn.href = apk.browser_download_url;
          fnameEl.textContent = apk.name || "app-release.apk";
        } else {
          // æ²¡æ‰¾åˆ° apkï¼Œå›é€€åˆ° release é¡µé¢
          dlBtn.href = data.html_url;
          dlBtn.textContent = "å‰å¾€ Release ä¸‹è½½";
          fnameEl.textContent = "â€”";
        }

        // Release é¡µé¢é“¾æ¥
        relBtn.href = data.html_url || `https://github.com/${OWNER}/${REPO}/releases`;

        // è¯´æ˜
        const body = (data.body || "").trim();
        const html = body
          ? body.split(/\n{2,}/).map(p => `<div class="item">${p.replace(/\n/g,"<br>")}</div>`).join("")
          : `<div class="item">æš‚æ— è¯´æ˜ã€‚å¯å‰å¾€ <a href="${relBtn.href}" target="_blank" rel="noopener">Release é¡µé¢</a> æŸ¥çœ‹è¯¦æƒ…ã€‚</div>`;
        notes.innerHTML = html;

        // è§£æ SHA256
        const sha = extractSHA(body);
        if (sha) {
          shaEl.textContent = sha;
        } else {
          shaEl.textContent = "å°šæœªæä¾›";
        }
      } catch (e) {
        // æ•…éšœå›é€€ï¼šæŒ‡å‘ Releases åˆ—è¡¨
        verEl.textContent = FORCE_TAG || "â€”";
        pubEl.textContent = "â€”";
        document.getElementById("dl").href = `https://github.com/${OWNER}/${REPO}/releases`;
        document.getElementById("dl").textContent = "å‰å¾€ Releases ä¸‹è½½";
        document.getElementById("rel").href = `https://github.com/${OWNER}/${REPO}/releases`;
        document.getElementById("notes").innerHTML = `<div class="item">æ— æ³•è¯»å– Release ä¿¡æ¯ï¼ˆ${e.message}ï¼‰ã€‚è¯·å‰å¾€ <a href="https://github.com/${OWNER}/${REPO}/releases" target="_blank" rel="noopener">Releases</a> æŸ¥çœ‹ã€‚</div>`;
        document.getElementById("sha").textContent = "â€”";
        document.getElementById("fname").textContent = "â€”";
      }
    }

    loadRelease();
  </script>
</body>
</html>
